#!/bin/bash
#
# usage: juncp [-j junction-root] [-c name-length] [dir-path]

set -e

NC='\033[0m'
RED='\033[0;31m'
GREEN='\033[0;32m'
CYAN='\033[0;36m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
YELLOW='\033[1;33m'

junc_root="/c/junc"
name_length=5
dir_path="$PWD"

usage_short="${BLUE}usage: juncp [-j junction-root] [-c name-length] [dir-path]"
usage_long="$usage_short\n-j: path to junction root (default: $junc_root)"
usage_long="$usage_long\n-c: length of randomly generated junction names (default: $name_length)"
usage_long="$usage_long\ndir-path: path to the directory getting junctioned (default: $dir_path)${NC}"

usage_short="$usage_short\nuse -h to get supported command information.${NC}"

options=":j:c:h"
shopt -u nocasematch
OPTIND=1
while getopts "$options" opt ; do
    case "$opt" in
    j )
      junc_root="$OPTARG"
      ;;
    c )
      name_length="$OPTARG"
      ;;
    h )
      >&2 echo -e "$usage_long" && exit 1
      exit 0
      ;;
    \?)
      >&2 echo -e "Unknown option: -$OPTARG"
      >&2 echo -e "$usage_short"
      exit 1
      ;;
    : )
      >&2 echo -e "Missing option argument for -$OPTARG"
      >&2 echo -e "$usage_short"
      exit 1
      ;;
    * )
      >&2 echo -e "Unimplemented option: -$OPTARG" && exit 1
      >&2 echo -e "$usage_short"
      exit 1
    esac
done
shift $((OPTIND-1))

if [ "$1" != "" ] ; then
  dir_path="$1"
  shift
fi

junc -p -j "$junc_root" -c "$name_length" "$dir_path"
